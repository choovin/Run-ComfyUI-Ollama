# 20260213-202811 ACR镜像自动构建发布与版本标签更新

## 变更背景
为项目增加 GitHub Actions 自动构建并推送镜像到阿里云 ACR，统一镜像发布流程，并让镜像标签携带 ComfyUI 与 Ollama 版本信息，便于追踪与回滚。

## 本次改动
- 新增工作流：`.github/workflows/docker-acr.yml`
- 更新镜像发布说明：`README.md`
- 参数化 Docker 构建版本：`Dockerfile`

## 工作流能力
- 支持两种触发方式：
  - 推送 Git Tag（`v*`）触发发布
  - `workflow_dispatch` 手动触发发布
- 推送仓库：
  - `registry.cn-shenzhen.aliyuncs.com/sailfish/runnode-run-comfyui-ollama`
- 支持可选推送 `latest` 标签（手动触发时）

## 镜像标签规范
镜像标签格式：

```text
<image_version>-comfyui-<comfyui_version>-ollama-<ollama_version>
```

示例：

```text
v1.0.0-comfyui-07092025-ollama-latest
```

## 版本来源规则
- `comfyui_version`：默认读取 `Dockerfile` 中 `ARG COMFYUI_VERSION`
- `ollama_version`：默认读取 `Dockerfile` 中 `ARG OLLAMA_VERSION`
- 也可在手动触发工作流时显式传入覆盖默认值

## 仓库配置要求
需在 GitHub 仓库 Secrets 中配置：
- `ALICLOUD_REGISTRY_USERNAME`
- `ALICLOUD_REGISTRY_PASSWORD`

## 结果
完成后可直接通过以下方式拉取发布镜像：

```bash
docker pull registry.cn-shenzhen.aliyuncs.com/sailfish/runnode-run-comfyui-ollama:<版本号>
```
